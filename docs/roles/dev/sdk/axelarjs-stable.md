# Stable (v0.4.xx)

## Overview

The AxelarJS SDK empowers developers to make cross-chain transfers using the Axelar network from their frontend.

Note: this version applies to the SDK version v0.4.XX. Versions v0.5.xx+ is in active development and currently in "alpha" phase. Updated documentation for the alpha versions will be placed in the "alpha" section of these sdk docs. 

### Latest Version

[v0.4.29](https://www.npmjs.com/package/@axelar-network/axelarjs-sdk/v/0.4.29)

### Example use case: asset transfer

AxelarJS enables the transfer of crypto assets across any blockchain supported by Axelar.

Currently supported assets and chains:

| Supported Assets                                                                                             | Supported Blockchain Networks                                                                                             |
| ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------- |
| <ul><li>LUNA (Terra native token)</li><li>UST (Terra stablecoin)</li><li>USDC</li><li>FRAX</li></ul> | <ul><li>Avalanche</li><li>Cosmoshub</li><li>Ethereum</li><li>Fantom</li><li>Moonbeam</li><li>Osmosis</li><li>Polygon</li><li>Terra</li></ul> |

Axelar will continue to add support for new assets and chains in the future.

## Technical overview

The AxelarJS SDK is a `npm` dependency that includes libraries that make requests into the Axelar network.

![Architecture diagram](/img/sdk-diagram.png)

Any request from the JS SDK is routed through a node REST server that redirects requests through a coordinated collection of microservices controlled by Axelar.

These microservices facilitate the relay of cross-chain transactions that run on top of the Axelar network.

## Security mesures

AxelarJS employs security measures to protect our services from abuse. Currently every invocation of `getDepositAddress` requires frontend users to connect to a Web3 wallet and sign a message with a one-time code. Invocations to the API are also rate limited.

## Getting Started

### Install the latest dependency

```bash
npm i --save @axelar-network/axelarjs-sdk@latest
```

### Generate a deposit address

The snippets below can be used to generate a deposit address in testnet for a transfer of AXL tokens from the Axelar Network to Avalanche. 

A few helpful notes:
1. At the moment, the SDK requires an environment variable called `REACT_APP_STAGE` ("testnet" or "mainnet"). We are working to remove this requirement in 0.5.xx+.
2. As stated in `Security Measures` above, the invocation of `getDepositAddress` will require cryptographic signature of a one-time message (generated by our servers) by a wallet. The signature is a required parameter for the request payload in `getDepositAddress`. The code snippet assumes you have `ethersjs` installed. 
    - The `getNoncedMessageToSign` below retrieves the one-time message from our servers. 
    - `promptUserToSignMessage` will prompt users to sign this message. 

```typescript

const api: AxelarAPI = new TransferAssetBridge(process.env.REACT_APP_STAGE);

/*below is sample implementation using ethers.js, but you can use whatever you want*/
const provider = new ethers.providers.Web3Provider(window.ethereum, "any"); //2nd param is network type
const signerAuthority = provider.getSigner();
const signerAuthorityAddress = signerAuthority.getAddress();

const getNoncedMessageToSign = async () => {
  const signerAuthorityAddress = await signerAuthority.getAddress();
  const { validationMsg, otc } = await api.getOneTimeCode(signerAuthorityAddress);
  return { validationMsg, otc };
};

const promptUserToSignMessage = async () => {
  const { validationMsg, otc } = await getNoncedMessageToSign();
  const signature = await signerAuthority.signMessage(validationMsg);

  return {
    otc,
    publicAddr: await signerAuthority.getAddress(),
    signature,
  };
};
```
3. After calling `promptUserToSignMessage`, you will get the values for `otc`, `publicAddr`, and `signature` for the inputs for `getDepositAddress`.
    - After `getDepositAddress` is invoked, the response in the results is a one-time deposit address. 

```typescript
const getDepositAddress = async (destinationAddress?: string) => {
  const { otc, publicAddr, signature } = await promptUserToSignMessage();
  const parameters: AssetTransferObject = getParameters(
    destinationAddress || publicAddr
  ); // wherever you specify for the destination address on the destination chain
  parameters.otc = otc;
  parameters.publicAddr = publicAddr;
  parameters.signature = signature;

  const linkAddress = await api.getDepositAddress(parameters, true);

  return linkAddress;
};
```

The `getDepositAddress` method takes the following parameters:

1. `requestPayload`: a complex struct of type `AssetTransferObject`
2. optional parameter on whether you want error alerts to show on the UI or not

Sample parameters for a transfer of AXL tokens from Axelar Network to the Avalanche network:

```typescript
// getParameters.ts

const getParameters = (
  destinationAddress: string,
  sourceChainName: string = "axelar",
  destinationChainName: string = "avalanche",
  asset_common_key: string = "uaxl"
) => {
  /*
	info for sourceChainInfo and destinationChainInfo fetched from the ChainList module of the SDK. 
	* */
  const axelarChain: ChainInfo = ChainList.map(
    (chain: Chain) => chain.chainInfo
  ).find(
    (chainInfo: ChainInfo) =>
      chainInfo.chainName.toLowerCase() === sourceChainName.toLowerCase()
  ) as ChainInfo;
  const avalancheChain: ChainInfo = ChainList.map(
    (chain: Chain) => chain.chainInfo
  ).find(
    (chainInfo: ChainInfo) =>
      chainInfo.chainName.toLowerCase() === destinationChainName.toLowerCase()
  ) as ChainInfo;
  const assetObj = axelarChain.assets?.find(
    (asset: AssetInfo) => asset.common_key === asset_common_key
  ) as AssetInfo;

  let requestPayload: AssetTransferObject = {
    sourceChainInfo: terraChain,
    destinationChainInfo: avalancheChain,
    selectedSourceAsset: assetObj,
    selectedDestinationAsset: {
      ...assetObj,
      assetAddress: destinationAddress, //address on the destination chain where you want the tokens to arrive
    },
    signature: "SIGNATURE_FROM_METAMASK_SIGN",
    otc: "OTC_RECEIVED_FROM_SERVER",
    publicAddr: "SIGNER_OF_SIGNATURE",
    transactionTraceId: "YOUR_OWN_UUID", //your own UUID, helpful for tracing purposes. optional.
  };

  return requestPayload;
};
```

4. After you generate a deposit address with the code above, you can make a deposit of AXL tokens into that address to facilitate the rest of the transfer.
    - Hint: You can use the [testnet faucet](https://faucet.testnet.axelar.dev/) to make this deposit.
    - After some time, you can check your balance on an Avalanche block explorer (e.g. [Snowtrace](https://testnet.snowtrace.io/)). The relevant token contract for AXL tokens on Avalanche (testnet) is `0x46Cc87ea84586C03bB2109ED9B33F998d40B7623`. 

## Demo

See AxelarJS in action: [deposit-address-demo](https://github.com/axelarnetwork/deposit-address-demo)

This demo app is a small Quick Start that contains the code above that can get you started with your project. 

## AxelarJS is under active development

AxelarJS is under active development. The API might change. Please ensure you pull the latest from this repo post issues to Github.

## Contribute

Github issues and pull requests are welcome!